never
mkdir: cannot create directory ‘log_files/’: File exists


Summary file: eval_/LLAMA-3.1_8B/50_threads/malloc/base_pages/inp_len_1024/out_len_31744/batch_size_4/iter_1/20250707-154247/exec/summary.log
CPU count is 224
SMT is on
PID: 509804
Namespace(model_id='meta-llama/Llama-3.1-8B', device='cpu', dtype='bfloat16', weight_dtype=None, input_tokens='1024', max_new_tokens=31744, prompt=None, summary_file='eval_/LLAMA-3.1_8B/50_threads/malloc/base_pages/inp_len_1024/out_len_31744/batch_size_4/iter_1/20250707-154247/exec/summary.log', greedy=True, ipex=False, use_tpp=True, tpp_linear_only=False, tpp_no_opt=False, jit=False, num_iter=1, num_warmup=0, batch_size=4, token_latency=True, profile=False, dist_backend='ccl', load_sharded_model=False, save_sharded_model=False)
model_type llama
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00, 11.44it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 14.73it/s]
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
my_size=1 Nq=32 Nkv=8 wt dt=c10::BFloat16 H=128
---- Prompt size: 1024
---- Prompt text: Once upon a time, there existed a little girl, who liked to have adventures. She wanted to go to places and meet new people, and have fun. In those days I talked a lot about weapons. There was David, the lone soldier who lived with the old lady. It was unclear whether they were related. On Friday afternoons David was always out on the balcony in boxer shorts and an undershirt, cleaning his short barrel M-16 in the sun, smoking and sweating for an hour or two, and I would watch him from our balcony and say, what a waste of manpower. The first time I thought about it was when I overheard him talking on the phone, he was saying that the IDF is the biggest whorehouse in the country, everyone is all over each other ‒ male officers and female soldiers, male soldiers and female commanders, female commanders and male ones, male commanders amongst themselves. David was tall and fair, he had the arrogant air of a proud Russian. His pale hairy legs shone in the sun, and the shadow underneath his armpits brought up memories of days long past: crumpled-up newspapers featuring lipstick ads that were scattered all over the floor of the army tent during basic training. I had it all figured out, right down to the last detail. I spent hours on the balcony with the door closed behind me while David sat on the oil stained railing, the old lady had tried cleaning it but never managed to get the stains out. Apart from the old lady, David didn’t have any family in Israel. My family was merely background noise: my wife, Iris, who took care of behaviorally challenged kids, and the twins, Ben and Beth.1 Ben took an immediate liking to the scouts; he once dragged a gigantic wooden beam home to prove his devotion, and Beth started her own blog online. I don’t know what she did there. In the free community newspaper they deliver to every house, I read that the security situation was heating up and caution should be exercised. Children should not be out alone after dark; power locks should be installed in the car; a home security system indoors; they even steal dogs, it said. When we started giving things up, when it became a struggle to buy things for the house, when I gave up cigarettes, we used copies of the community newspaper that had piled up – seven, eight or nine in the front entrance of each house – to line the boxes we packed and placed in the reinforced security room. I studied David’s short, jagged toenails, the way he played with them in the hot air and tried to think about Iris. The way he sits with his legs wide apart, concentrating, dismantling the weapon down to its smallest parts, using a brush and a flannel cloth to clean them. When Iris would return from one of her conferences, she smelled of other counselors’ perfumes. It was summer, and the average temperature was thirty-eight degrees Celsius. I missed the city. I slept outside, on the balcony, at night, and whenever the security jeeps drove by, they would temporarily blind me. All we ever wanted was a nice house in a quiet area. Well, we got it. Beth started attending Yoga for Children, which drained our checking account, and Ben was always in need of a monthly check for the scouts. David would spend weekends with the old lady, and when I sat on the balcony and Ben came out with a question about his homework, I tried to figure out why he couldn’t see David and only I could. I began thinking about what would happen if he agreed to give me his weapon. I’d go over all of the details with him. He’d file a report with the Military Police and tell them that it was stolen when he was attacked by a group of terrorists on his way to the base. He struggled, they were trying to kidnap him and one of them even attempted to inject him with something, but he managed to break free and they just got his weapon as he ran for his life. Tell them that you wounded one of them too, I planned on saying. He’d clean his weapon one last time, for my sake, and then hand it over along with the ammunition. The night the children disappeared began by someone alerting the neighborhood security watch. The jeeps started circling around, driving at full speed. Their Kojaks blinked like crazy. Police cars joined in, and searchlights lit up our dark silence. A group of scouts had gathered their equipment and gone hiking or went out to earn a badge or whatever it is that scouts do. It was Ben and his friends, like that kid who always comes over to our house smelling of iron. Beth disappeared too. Iris came home late. She stepped in from all of the noise, dropped her keys and said, “I don’t know what I’m going to do.” The police stopped by every house. Ben and his group, there were ten of them, weren’t the only ones missing. There were two girls
Iteration number: 1, total_time = 0.0 
/data/sathvik/tpp-pytorch-extension/miniforge3/envs/pt251/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:631: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/data/sathvik/tpp-pytorch-extension/miniforge3/envs/pt251/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:636: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Running At __init__():86  from /data/sathvik/tpp-pytorch-extension/miniforge3/envs/pt251/lib/python3.9/site-packages/tpp_pytorch_extension/llm/fused_llama_infer.py:270:LlamaModel_forward()
BNSqRH: 4 8 1024 4 128
S S1 S2: 1024 32 32
Attn: Sqb = 16 Skb = 4 qrem = 0 use_flash = True
Key: s1_str = 131072 s2_str = 128 b_str = 32768 n_str = 4096 h_str = 1 in_vnni = 0
Value: s1_str = 131072 s2_str = 128 b_str = 32768 n_str = 4096 h_str = 1 in_vnni = 0
S2 = 32 kl_needs_trans = 1
### ##: #KEY#      :   BRGEMM    Total    ITotal    OTotal    MTotal  Count TotalGFS (IMBL)   TF/s
TID  0: FWD        :   1806.0   2622.7    2445.3    2826.8    7856.6     33 57178.807 (99.90) 31.660
TID  0: ac_gemm1   :      0.0      0.0       0.0     202.3     209.4     32
TID  0: pln_gemm   :      5.2      5.2       5.2       5.5     280.8      1    4.203 (97.76)  0.814
TID  0: fqkv_gemm  :    177.0    224.6     227.3     292.0     303.5     32 6597.070 (99.90) 37.274
TID  0: proj_gemm  :    150.7    160.3     162.6     168.5     169.2     32 4398.047 (99.90) 29.184
TID  0: mha        :      0.0      0.0       0.0       0.0     743.2     32
TID  0: o_gemm     :    616.5    627.4     630.4     633.2     636.7     32 15393.163 (99.90) 24.967
TID  0: i_gemm     :    856.7   1399.8    1419.8    1469.5    1479.8     64 30786.326 (99.90) 35.938
TID  0: lnorm      :      0.0     20.2       0.0      24.0      25.8     64
TID  0: rotary     :      0.0      0.0       0.0      31.9      32.0     64
TID  0: fftkn      :      0.0    185.2       0.0       0.0    1138.9    224
TID  0: pt_op      :      0.0      0.0       0.0       0.0    2837.0     32
Hash create: 1.239 ms   Hash search: 294.075 ms
